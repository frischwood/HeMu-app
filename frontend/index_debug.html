<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heliomont DML - Solar Irradiance Viewer</title>
    
    <!-- MapLibre GL CSS -->
    <link href='https://unpkg.com/maplibre-gl@latest/dist/maplibre-gl.css' rel='stylesheet' />
    
    <!-- Font Awesome for icons -->
    <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css' rel='stylesheet' />
    
    <style>
        /* Complete CSS reset and forced positioning */
        * {
            margin: 0 !important;
            padding: 0 !important;
            box-sizing: border-box !important;
        }
        
        html, body {
            height: 100vh !important;
            width: 100vw !important;
            overflow: hidden !important;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
            background: #1a1a1a !important;
            color: #ffffff !important;
        }
        
        /* Full-screen map */
        #map {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 1 !important;
            background: #2d2d2d;
        }
        
        /* Sidebar */
        .sidebar {
            position: fixed !important;
            top: 0 !important;
            right: 0 !important;
            width: 380px !important;
            height: 100vh !important;
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(40, 40, 40, 0.95) 100%) !important;
            backdrop-filter: blur(10px) !important;
            border-left: 1px solid rgba(255, 255, 255, 0.1) !important;
            z-index: 1000 !important;
            transform: translateX(0) !important;
            transition: transform 0.3s ease !important;
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.3) !important;
            overflow-y: auto !important;
        }
        
        .sidebar.collapsed {
            transform: translateX(340px) !important;
        }
        
        .sidebar-header {
            display: flex !important;
            align-items: center !important;
            justify-content: space-between !important;
            padding: 1.5rem !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
            background: rgba(255, 255, 255, 0.05) !important;
        }
        
        .sidebar-header h2 {
            font-size: 1.25rem !important;
            font-weight: 600 !important;
            color: #fff !important;
            display: flex !important;
            align-items: center !important;
            gap: 0.5rem !important;
        }
        
        .sidebar-header i {
            color: #fbbf24 !important;
        }
        
        .sidebar-toggle {
            background: rgba(255, 255, 255, 0.1) !important;
            border: none !important;
            color: #fff !important;
            width: 32px !important;
            height: 32px !important;
            border-radius: 6px !important;
            cursor: pointer !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            transition: all 0.2s ease !important;
        }
        
        .sidebar-toggle:hover {
            background: rgba(255, 255, 255, 0.2) !important;
        }
        
        .sidebar-content {
            padding: 1rem !important;
        }
        
        .control-section {
            margin-bottom: 1.5rem !important;
            padding: 1rem !important;
            background: rgba(255, 255, 255, 0.05) !important;
            border-radius: 6px !important;
        }
        
        .control-section h3 {
            color: #e5e7eb !important;
            font-size: 1rem !important;
            margin-bottom: 1rem !important;
            display: flex !important;
            align-items: center !important;
            gap: 0.5rem !important;
        }
        
        .control-section h3 i {
            color: #60a5fa !important;
        }
        
        .control-group {
            margin-bottom: 1rem !important;
        }
        
        .control-group label {
            display: block !important;
            font-size: 0.875rem !important;
            color: #d1d5db !important;
            margin-bottom: 0.5rem !important;
        }
        
        .select-input, .time-slider, .opacity-slider {
            width: 100% !important;
            background: rgba(255, 255, 255, 0.1) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 6px !important;
            color: #fff !important;
            font-size: 0.875rem !important;
            padding: 0.5rem !important;
        }
        
        .current-time {
            text-align: center !important;
            padding: 0.75rem !important;
            background: rgba(96, 165, 250, 0.1) !important;
            border-radius: 6px !important;
            margin: 1rem 0 !important;
        }
        
        .current-time strong {
            color: #60a5fa !important;
        }
        
        .btn {
            padding: 0.5rem 1rem !important;
            border: none !important;
            border-radius: 6px !important;
            background: #10b981 !important;
            color: white !important;
            cursor: pointer !important;
            margin: 0.25rem !important;
        }
        
        .btn:hover {
            background: #059669 !important;
        }
        
        .info-text {
            color: #d1d5db !important;
            font-size: 0.875rem !important;
        }
        
        /* Map controls */
        .map-controls {
            position: fixed !important;
            top: 1rem !important;
            left: 1rem !important;
            z-index: 999 !important;
            display: flex !important;
            flex-direction: column !important;
            gap: 0.5rem !important;
        }
        
        .map-btn {
            width: 40px !important;
            height: 40px !important;
            background: rgba(26, 26, 26, 0.9) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            border-radius: 6px !important;
            color: #fff !important;
            cursor: pointer !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }
        
        /* Debug styles */
        .sidebar {
            border: 2px solid red !important; /* Temporary debug border */
        }
        
        #map {
            border: 2px solid blue !important; /* Temporary debug border */
        }
    </style>
</head>
<body>
    <!-- Full-screen map container -->
    <div id="map"></div>
    
    <!-- Collapsible sidebar -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h2><i class="fas fa-sun"></i> Solar Irradiance</h2>
            <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Toggle sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Date range info -->
            <div class="control-section">
                <h3><i class="fas fa-calendar"></i> Data Range</h3>
                <p id="range-info" class="info-text">Loading date range...</p>
            </div>

            <!-- Date/Time Control -->
            <div class="control-section">
                <h3><i class="fas fa-clock"></i> Time Selection</h3>
                <div class="control-group">
                    <input type="range" id="date-slider" min="0" value="0" step="1" class="time-slider">
                </div>
                <div class="current-time">
                    <strong id="current-date">Select a time</strong>
                </div>
                <div style="text-align: center;">
                    <button id="play-btn" class="btn" aria-label="Play animation">
                        <i class="fas fa-play"></i> Play
                    </button>
                    <button id="pause-btn" class="btn" style="display: none;" aria-label="Pause animation">
                        <i class="fas fa-pause"></i> Pause
                    </button>
                    <button id="reset-btn" class="btn" aria-label="Reset to start">
                        <i class="fas fa-backward"></i> Reset
                    </button>
                </div>
            </div>

            <!-- Layer Controls -->
            <div class="control-section">
                <h3><i class="fas fa-layer-group"></i> Basemap</h3>
                <div class="control-group">
                    <label for="basemap-select">Style:</label>
                    <select id="basemap-select" class="select-input">
                        <option value="osm">OpenStreetMap</option>
                        <option value="satellite">Satellite</option>
                        <option value="terrain">Terrain</option>
                        <option value="dark">Dark</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="basemap-opacity">Opacity:</label>
                    <input type="range" id="basemap-opacity" min="0" max="100" value="100" class="opacity-slider">
                    <span id="basemap-opacity-value">100%</span>
                </div>
            </div>

            <!-- Data Layer Controls -->
            <div class="control-section">
                <h3><i class="fas fa-chart-area"></i> Data Layer</h3>
                <div class="control-group">
                    <label for="data-layer">Variable:</label>
                    <select id="data-layer" class="select-input">
                        <option value="SISGHI-No-Horizon">Solar Irradiance</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="data-opacity">Opacity:</label>
                    <input type="range" id="data-opacity" min="0" max="100" value="80" class="opacity-slider">
                    <span id="data-opacity-value">80%</span>
                </div>
                <div class="control-group">
                    <label for="colormap-select">Color Scheme:</label>
                    <select id="colormap-select" class="select-input">
                        <option value="magma">Magma (Purple-Pink)</option>
                        <option value="viridis">Viridis (Blue-Green)</option>
                        <option value="plasma">Plasma (Purple-Yellow)</option>
                        <option value="turbo">Turbo (Rainbow)</option>
                        <option value="hot">Hot (Red-Yellow)</option>
                        <option value="cool">Cool (Blue-Cyan)</option>
                    </select>
                </div>
            </div>

            <!-- Data Info -->
            <div class="control-section">
                <h3><i class="fas fa-info-circle"></i> Current Data</h3>
                <div>
                    <p>Min Value: <span id="current-vmin">--</span></p>
                    <p>Max Value: <span id="current-vmax">--</span></p>
                    <p>Unit: W/m²</p>
                </div>
            </div>

            <!-- Debug -->
            <div class="control-section">
                <h3><i class="fas fa-bug"></i> Debug</h3>
                <div id="debug" style="font-family: monospace; font-size: 0.75rem; background: rgba(0,0,0,0.3); padding: 0.5rem; border-radius: 4px;"></div>
                <div id="error" style="font-family: monospace; font-size: 0.75rem; background: rgba(255,0,0,0.1); padding: 0.5rem; border-radius: 4px; border-left: 3px solid red; margin-top: 0.5rem;"></div>
            </div>
        </div>
    </div>

    <!-- Map controls overlay -->
    <div class="map-controls">
        <button id="fullscreen-btn" class="map-btn" aria-label="Toggle fullscreen">
            <i class="fas fa-expand"></i>
        </button>
        <button id="home-btn" class="map-btn" aria-label="Reset view">
            <i class="fas fa-home"></i>
        </button>
    </div>

    <!-- Scripts -->
    <script src='https://unpkg.com/maplibre-gl@latest/dist/maplibre-gl.js'></script>
    <script src='app.js'></script>
</body>
</html>
